---
title: PDS Change of Address 
keywords:  messaging, bundles
tags: [fhir,messaging]
sidebar: overview_sidebar
permalink: pds_change_of_address.html
summary: "The FHIR profiles used for the PDS Change of Address event message bundle"
---

`PDS Change of Address` event messages are generated by the Spine and published to the NEMS when the `H (usual)` address of a patient is changed within their PDS record. The event message will contain the patient's new address and their previous address as per the guidance below.

{% include important.html content="There is a known issue with the way providers updated patient demographics on PDS. There is a common issue where address details flip flop on PDS as different providers update spine with the same address just in a different format as the PDS format does not match their own stored address format. This is being highlighted as it will cause an artificially increased number of `Change of Address` event messages being generated by PDS and flowing through the NEMS." %}

The `PDS Change of Address` event message is intended for the purpose of notifying subscribers that a patients address has been updated on PDS, and should be used as follows:
- The address details contained within the event message should only be used for the purpose of determining if the subscriber should take some action as a result of the address change.
- The address format within the event message may be different to the format of the address within PDS, due to contraints of FHIR, therefore the address received in the event message should not be used in place of PDS synchronisation.
- Subscribers receiving the change of address event message MUST not update PDS with the address details or format received in the event message as this may result in the address flip flop issue highlighted above.

Where a subscriber is using one of the [residential subscription rules](explore_subscriptions.html) for subscribing to the PDS Change of Address event, the event message will be sent to any subscibers which have a subscription that matches either the current address or previous address, which allows for notificaiton of movers in or movers out.

## Bundle structure

Specifies mandatory referencing within the Event Message Bundle.

<div style="text-align:center; margin-bottom:20px" >
	<a href="images/messages/change_of_address_bundle.png" target="_blank"><img src="images/messages/change_of_address_bundle.png"></a>
	<p>PDS Change of Address Bundle <a href="images/messages/change_of_address_bundle.png" target="_blank">(open in new TAB)</a></p>
</div>

The `CareConnect-Patient-1` resource within the bundle will contain two addresses, one will represent the patient's old address and one will represent the patients new address and will be identifiable by the `use` element within the addresses.


## PDS Change of Address Message Life Cycle ##

The `PDS Change of Address` event message will always contain a `messageEventType` extension with value `new` in the MessageHeader resource. There will be no `update` or `delete` version of this event message.

If a subscriber receives multiple `PDS Change of Address` event messages for the same patient, the latest event message as indicated by the `meta.lastUpdated` element within the MessageHeader resource should be considered the source of truth for the patient's correct address.

{% include important.html content="`PDS Change of Address` event messages will only be triggered for updates to the patient's home address on the Spine. Changes to a patient temporary address on Spine will not trigger a `PDS Change of Address` event message to be sent through the EMS." %}


## Onward Delivery ##

The delivery of the PDS Change of Address event messages to subscribers via MESH will use the following `WorkflowID` within the MESH control file. This `WorkflowID` will need to be added to the receiving MESH mailbox configuration before event messages can be received.

| MESH WorkflowID | `CHANGEOFADDRESS_1` |


## Resource Population Requirements and Guidance ##

The following requirements and resource population guidance should be followed in addition to the requirements and guidance outlined in the [Generic Requirements](explore_generic_event_requirements.html) page.


### [Bundle](http://hl7.org/fhir/STU3/StructureDefinition/Bundle)

The Bundle resource is the container for the event message and SHALL conform to the [Bundle](http://hl7.org/fhir/STU3/StructureDefinition/Bundle) FHIR profile.

| Resource Cardinality | 1..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| type | 1..1 | Fixed value: `message` |


### [Event-MessageHeader-1](https://fhir.nhs.uk/STU3/StructureDefinition/Event-MessageHeader-1)

The MessageHeader resource included as part of the event message SHALL conform to the [Event-MessageHeader-1](https://fhir.nhs.uk/STU3/StructureDefinition/Event-MessageHeader-1) constrained FHIR profile and the additional population guidance as per the table below:

| Resource Cardinality | 1..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| meta.lastUpdated | 1..1 | DateTime when the patient record was updated with the details included in this event message. This element should be used for message sequencing |
| extension(messageEventType) | 1..1 | Fixed value: `new` |
| event | 1..1 | Fixed Value: pds-change-of-address-1 (PDS Change of Address) |
| responsible | 1..1 | This will reference the source organization of the event message.<br/> For PDS events this will be a reference to a CareConnect-Organization-1 resource within the message bundle. **\*** |
| focus | 1..1 | This will reference the "CareConnect-Communication-1" resource which contains information relating to the event message. |


### [CareConnect-Communication-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Communication-1)

The Communication resource included in the event message SHALL conform to the [CareConnect-Communication-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Communication-1) constrained FHIR profile and the additional population guidance as per the table below:

| Resource Cardinality | 1..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| status | 1..1 | Fixed value: `completed` |
| sender | 0..1 | This will reference the sending organization of the event message.<br/> For PDS events this will be a reference to a CareConnect-Organization-1 resource within the message bundle. **\***|
| subject | 1..1 | This will reference the patient resource representing the patient who is the subject of this event. |


### [CareConnect-Patient-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Patient-1)

The patient resource included in the event message SHALL conform to the [CareConnect-Patient-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Patient-1) constrained FHIR profile and the additional population guidance as per the table below:

| Resource Cardinality | 1..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| meta.versionId | 1..1 | This element will contain the serial change number (SCN) of the patient record within Spine at the time this event was published. |
| identifier | 1..1 | Patient NHS Number SHALL be included within the nhsNumber identifier slice |
| **Current Address** |
| address.use | 1..1 | Fixed value: **home** |
| address.line | 1..* | Current address lines.<br/><br/>The address lines SHALL appear within the resource in the order they appear in PDS. Blank lines in the PDS address will not be included within the FHIR resource.<br/><br/>PDS does not differentiate `City` and `District` from other address lines, as a result it would not be reliable to extract these elements to populate the FHIR `city` and `district` elements therefore the all address lines, including city and district, will be included within the resource `address.line` elements. |
| address.postalcode | 1..1 | Current address post code |
| address.text | 1..1 | Text representation of the patient's current address in full |
| address.period.start | 1..1 | The date from which the patient's current address was valid |
| **Previous Address** |
| address.use | 1..1 | Fixed value: **old** |
| address.line | 1..* | Previous address lines.<br/><br/>The address lines SHALL appear within the resource in the order they appeared in PDS. Blank lines in the PDS address will not be included within the FHIR resource.<br/><br/>PDS does not differentiate `City` and `District` from other address lines, as a result it would not be reliable to extract these elements to populate the FHIR `city` and `district` elements therefore the all address lines, including city and district, will be included within the resource `address.line` elements. |
| address.postalcode | 1..1 | Previous address post code |
| address.text | 1..1 | Text representation of the patient's previous address in full |
| address.period.start | 1..1 | The date from which the patient's previous address was valid |
| address.period.end | 0..1 | The date from which the patient's previous address was no longer their current address |



### [CareConnect-Organization-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1)

The Organization resource(s) included in the event message SHALL conform to the [CareConnect-Organization-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1) constrained FHIR profile and the additional population guidance as per the table below:

| Resource Cardinality | 1..2 |

| Element | Cardinality | Additional Guidance |
|---------|-------------|---------------------|
| identifier.system | 1..1 | Fixed value: https://fhir.nhs.uk/Id/ods-organization-code |
| identifier.value | 1..1 | Organisation's ODS Organization Code |
| name | 1..1 | Organisation's Name |

**\*** Organization details may be retrieved using the [ODS Lookup API](https://developer.nhs.uk/apis/ods/restfulapis_identification_organization.html) as [ODSAPI-Organization-1](https://fhir.nhs.uk/STU3/StructureDefinition/ODSAPI-Organization-1) resources. These MUST then be transformed to [CareConnect-Organization-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1) resources for use within the event message bundle.

**NB:** 'responsible' and 'sender' organisations may be the same or different organisations, therefore requiring a single or two CareConnect-Organization-1 resources within the event message bundle.


### [CareConnect-HealthcareService-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-HealthcareService-1)

The HealthcareService resource included in the event message SHALL conform to the [CareConnect-HealthcareService-1](https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-HealthcareService-1) constrained FHIR profile and the additional population guidance as per the table below:

| Resource Cardinality | 0..1 |

| Element | Cardinality | Additional Guidance |
| --- | --- | --- |
| providedBy | 1..1 | This will reference the 'sender' organization of the event message. |
| type | 1..1 | Fixed value: PDS (Personal Demographics Service)<br/>This will represent the type of service responsible for the event message. This will have a value from the ValueSet [EMS-HealthcareServiceType-1](https://fhir.nhs.uk/STU3/ValueSet/EMS-HealthcareServiceType-1) |


## PDS Change of Address Example ##

```xml
{% include_relative examples/PDS-Change-Of-Address-ems-example.xml %}
```
